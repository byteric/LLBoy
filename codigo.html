<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LL Boy - Código</title>
    <link rel="stylesheet" href="estilos/estilo.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Share+Tech+Mono&display=swap"
        rel="stylesheet">
</head>

<body>
    <header>
        <div class="container">
            <h1>LL Boy</h1>
            <p>Projeto de Desarmamento de Bomba com Arduino</p>
            <nav>
                <a href="index.html" class="button">Home</a>
                <a href="tinkercad.html" class="button">TinkerCad</a>
                <a href="pecas.html" class="button">Peças</a>
                <a href="codigo.html" class="button">Código</a>
                <a href="proposito.html" class="button">Propósito</a>
                <a href="equipe.html" class="button">Equipe</a>
            </nav>
        </div>
    </header>

    <main>
        <section id="codigo" class="content-section">
            <div class="container">
                <h2 class="icon-codigo">Código C++ (Arduino IDE)</h2>
                <p>O cérebro do LL Boy! Aqui está o código-fonte completo desenvolvido em Arduino IDE.</p>
                <pre><code class="language-arduino">
#include <Keypad.h>
#include <Wire.h>
#include <LiquidCrystal_I2C.h>
#include <Ultrasonic.h>
#define LCD_COLS 16
#define LCD_ROWS 2
#define LCD_ADDR  0x27
#define pino_trigger A0
#define pino_echo A1

LiquidCrystal_I2C lcd(LCD_ADDR, LCD_COLS, LCD_ROWS);
Ultrasonic ultrasonic(pino_trigger, pino_echo);

const byte LINHAS = 4;
const byte COLUNAS = 4;
const char TECLAS_MATRIZ[LINHAS][COLUNAS] = {
  {'1', '2', '3', },
  {'4', '5', '6', },
  {'7', '8', '9', },
  {'*', '0', '#', }
};
const byte PINOS_LINHAS[LINHAS] = {10, 9, 8, 7};
const byte PINOS_COLUNAS[COLUNAS] = {6, 5, 4};
Keypad teclado_personalizado = Keypad(makeKeymap(TECLAS_MATRIZ), PINOS_LINHAS, PINOS_COLUNAS, LINHAS, COLUNAS);
int seconds = 30;
int valor1;
int valor2;
int potPin1 = A2;
int potPin2 = A3;
const int botaoPin1 = 3;
const int botaoPin = 2;
int cm = 0;
const char SENHA_CORRETA[] = "1234";
const byte MAX_DIGITOS_SENHA = 4;
char senhaDigitada[MAX_DIGITOS_SENHA + 1];
byte indiceSenha = 0;
bool digitandoSenha = false;

void setup() {
  Serial.begin(9600);
  Serial.println("Iniciando sistema de bomba...");

  lcd.init();
  lcd.backlight();
  lcd.clear();
  lcd.setCursor(0, 0);
  lcd.print("Vai explodir em");

  pinMode(13, OUTPUT);
  pinMode(12, OUTPUT);
  pinMode(11, OUTPUT);

  pinMode(botaoPin1, INPUT_PULLUP);
  pinMode(botaoPin, INPUT_PULLUP);
  
  memset(senhaDigitada, 0, sizeof(senhaDigitada));
}

void loop() {
  if (seconds == -1) {
    digitalWrite(13, HIGH);
    digitalWrite(12, HIGH);
    digitalWrite(11, HIGH);
    return;
  }

  if (seconds > 0) {
    if (!digitandoSenha) {
      lcd.setCursor(0, 1);
      lcd.print("     ");
      lcd.setCursor(0, 1);
      lcd.print(seconds);
      delay(1000);
      Serial.print(" tempo restante ");
      Serial.println(seconds);
      seconds--;
    }
  } else if (seconds == 0) {
    lcd.clear();
    lcd.setCursor(0, 0);
    lcd.print("BOOOM!!!");
    digitalWrite(13, LOW);
    digitalWrite(12, LOW);
    digitalWrite(11, LOW);
    delay(1000);
    Serial.print(" tempo restante ");
    Serial.println(seconds);
    while (true);
  }

  cm = ultrasonic.read();
  valor1 = analogRead(potPin1);
  valor2 = analogRead(potPin2);

  Serial.print("Distancia: ");
  Serial.print(cm);
  Serial.print("cm | Pot1: ");
  Serial.print(valor1);
  Serial.print(" | Pot2: ");
  Serial.println(valor2);

  if (seconds > 0 && !digitandoSenha) {
    if (valor1 > 750) {
      digitalWrite(13, HIGH);
      digitalWrite(12, LOW);
      digitalWrite(11, LOW);
    } else if (valor1 > 330) {
      digitalWrite(13, LOW);
      digitalWrite(12, HIGH);
      digitalWrite(11, LOW);
    } else {
      digitalWrite(13, LOW);
      digitalWrite(12, LOW);
      digitalWrite(11, HIGH);
    }
  }

  if (digitalRead(botaoPin) == LOW && valor2 < 200 && valor1 > 750 && seconds > 0) {
    lcd.clear();
    lcd.setCursor(0, 0);
    lcd.print("BOMBA DESARMADA!");
    delay(1000);
    seconds = -1;
    digitalWrite(13, HIGH);
    digitalWrite(12, HIGH);
    digitalWrite(11, HIGH);
    delay(2000);
  } else if(digitalRead(botaoPin) == LOW && valor2 >= 200 && valor1 > 750 && seconds > 0){
    lcd.clear();
    lcd.setCursor(0, 0);
    lcd.print("Valor do Pot2");
    lcd.setCursor(0, 1);
    lcd.print("errado");
    delay(2500);
    lcd.clear();
    lcd.setCursor(0, 0);
    lcd.print("Vai explodir em");
  }else if(digitalRead(botaoPin1) == LOW && valor2 < 200 && valor1 > 750 && seconds > 0){
    lcd.clear();
    lcd.setCursor(0, 0);
    lcd.print("botao apertado");
    lcd.setCursor(0, 1);
    lcd.print("errado");
    delay(2500);
    lcd.clear();
    lcd.setCursor(0, 0);
    lcd.print("Vai explodir em");
  }else if(digitalRead(botaoPin1) == LOW && valor2 >= 200 && valor1 > 750 && seconds > 0){
    lcd.clear();
    lcd.setCursor(0, 0);
    lcd.print("Pot2 incorreto");
    lcd.setCursor(0, 1);
    lcd.print("botao errado");
    delay(2500);
    lcd.clear();
    lcd.setCursor(0, 0);
    lcd.print("Vai explodir em");
  }

  if (digitalRead(botaoPin1) == LOW && seconds > 0 && !digitandoSenha) {
    int cm_current = ultrasonic.read();

    Serial.print("Tentativa de desarme via Botao 2 (pino 3) - Distancia: ");
    Serial.print(cm_current);
    Serial.println("cm");

    if (cm_current < 30 && valor2 >= 700 && valor1 > 330) {
      lcd.clear();
      lcd.setCursor(0, 0);
      lcd.print("BOMBA DESARMADA!");
      delay(1000);
      seconds = -1;
    }else if(digitalRead(botaoPin1)==LOW&&cm_current > 30 && valor2 >= 700 && valor1 > 330 && valor1 < 750){
      lcd.clear();
      lcd.setCursor(0, 0);
      lcd.print("Distancia");
      lcd.setCursor(0, 1);
      lcd.print("incorreta");
      delay(2500);
      lcd.clear();
      lcd.setCursor(0, 0);
      lcd.print("Vai explodir em");
    }else if(digitalRead(botaoPin1)==LOW&&cm_current < 30 && valor2 < 700 && valor1 > 330 && valor1 < 750){
      lcd.clear();
      lcd.setCursor(0, 0);
      lcd.print("Valor do Pot2");
      lcd.setCursor(0, 1);
      lcd.print("errado");
      delay(2500);
      lcd.clear();
      lcd.setCursor(0, 0);
      lcd.print("Vai explodir em");

    }
    else if(digitalRead(botaoPin1)==LOW && cm_current > 30 && valor2 < 700 && valor1 > 330 && valor1 < 750){
      lcd.clear();
      lcd.setCursor(0, 0);
      lcd.print("dist incorreta");
      lcd.setCursor(0, 1);
      lcd.print("pot2 incorreto");
      delay(2500);
      lcd.clear();
      lcd.setCursor(0, 0);
      lcd.print("Vai explodir em");
  }
  }else if(digitalRead(botaoPin)==LOW && valor1<750 && valor1>330){
      lcd.clear();
      lcd.setCursor(0, 0);
      lcd.print("botao apertado");
      lcd.setCursor(0, 1);
      lcd.print("errado");
      delay(2500);
      lcd.clear();
      lcd.setCursor(0, 0);
      lcd.print("Vai explodir em");
  }

  char leitura_teclas = teclado_personalizado.getKey();

  if (leitura_teclas && seconds > 0) {
    Serial.print("Tecla Pressionada: ");
    Serial.println(leitura_teclas);

    if (leitura_teclas == '*') {
      digitandoSenha = true;
      indiceSenha = 0;
      memset(senhaDigitada, 0, sizeof(senhaDigitada));
      lcd.clear();
      lcd.setCursor(0, 0);
      lcd.print("Senha:");
      lcd.setCursor(7, 0);
    } else if (digitandoSenha) {
      if (leitura_teclas == '#') {
        if (indiceSenha == MAX_DIGITOS_SENHA) {
          senhaDigitada[indiceSenha] = '\0';
          Serial.print("Senha Digitada: ");
          Serial.println(senhaDigitada);
          if (strcmp(senhaDigitada, SENHA_CORRETA) == 0 && valor1 < 330 && valor2 < 300) {
            lcd.clear();
            lcd.setCursor(0, 0);
            lcd.print("BOMBA DESARMADA!");
            delay(1000);
            seconds = -1;
          } else if (strcmp(senhaDigitada, SENHA_CORRETA) == 0 && valor1 < 330 && valor2 >= 300) {
            lcd.clear();
            lcd.setCursor(0, 0);
            lcd.print("Valor do Pot2");
            lcd.setCursor(0, 1);
            lcd.print("errado");
            digitalWrite(11, LOW);
            delay(200);
            digitalWrite(11, HIGH);
            delay(200);
            digitalWrite(11, LOW);
            delay(1500);
          } else {
            lcd.clear();
            lcd.setCursor(0, 0);
            lcd.print("Senha Incorreta!");
            digitalWrite(11, LOW);
            delay(200);
            digitalWrite(11, HIGH);
            delay(200);
            digitalWrite(11, LOW);
            delay(1500);
          }
        } else {
          lcd.clear();
          lcd.setCursor(0, 0);
          lcd.print("Senha Incorreta!");
          lcd.setCursor(0, 1);
          lcd.print("Curta demais!");
          delay(1500);
        }
        if (seconds > 0) {
          digitandoSenha = false;
          indiceSenha = 0;
          memset(senhaDigitada, 0, sizeof(senhaDigitada));
          lcd.clear();
          lcd.setCursor(0, 0);
          lcd.print("Vai explodir em");
        }
      } else if (indiceSenha < MAX_DIGITOS_SENHA) {
        senhaDigitada[indiceSenha] = leitura_teclas;
        indiceSenha++;
        lcd.setCursor(7 + indiceSenha - 1, 0);
        lcd.print(leitura_teclas);

        if (indiceSenha == MAX_DIGITOS_SENHA) {
          lcd.setCursor(0, 1);
          lcd.print("Pressione # p/ validar");
        }
      } else {
        lcd.clear();
        lcd.setCursor(0, 0);
        lcd.print("Max Digitos!");
        lcd.setCursor(0, 1);
        lcd.print("Pressione # ou *");
        delay(1500);
        lcd.clear();
        lcd.setCursor(0, 0);
        lcd.print("Senha:");
        lcd.setCursor(7, 0);
        lcd.print(senhaDigitada);
      }
    } else {
      Serial.println("Tecla ignorada (fora do modo senha)");
    }
  }

  delay(50);
}
                </code></pre>
                <p></p>
            </div>
        </section>

        <section id="codigo" class="content-section">
            <div class="container">
                <h2 class="icon-codigo">Código Python</h2>
                <p>Aqui está o código em python para fazer a introdução do som a simulação do LLBoy. Antes de fazer rodas, baixe as depêndencias com o "pip install pyserial playsound" no seu terminal.</p>
                <pre><code class="language-arduino">
import serial
import time
import winsound  # Só funciona no Windows

porta = 'COM7'  # Altere conforme necessário
baud_rate = 9600
ultima_contagem = None

def bip(frequencia, duracao):
    winsound.Beep(frequencia, duracao)

def explosao():
   
    winsound.Beep(1100, 5000)
    time.sleep(0.1)

   

try:
    arduino = serial.Serial(porta, baud_rate, timeout=1)
    time.sleep(2)
    print(f"Lendo da porta {porta}...\n")

    while True:
        if arduino.in_waiting > 0:
            linha = arduino.readline().decode('utf-8').strip()
            print(linha)

            if "tempo restante" in linha:
                partes = linha.split()
                tempo = int(partes[-1])

                if tempo != ultima_contagem:
                    ultima_contagem = tempo

                    # Define intervalo do bip baseado no tempo
                    if tempo > 20:
                        bip(1000, 200)  # Lento
                    elif tempo > 10:
                        bip(1000, 300)   # Médio
                    elif tempo > 0:
                        bip(1000, 400)   # Rápido
                    elif tempo == 0:
                        explosao()

except KeyboardInterrupt:
    print("\nEncerrado pelo usuário.")
finally:
    if 'arduino' in locals() and arduino.is_open:
        arduino.close()
                </code></pre>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 LL Boy. Todos os direitos reservados.</p>
        </div>
    </footer>

    <button id="scrollToTopBtn" title="Voltar ao Topo">🔝</button>
    <script src="js/script.js"></script>
</body>

</html>